Sub Macro1()
'
' Macro1 Macro
'

'

' insert 3 new columns
Columns("B:D").Select
Selection.Insert Shift:=xlToRight

'add titles to the 3 new columns
Range("$B$1").Value = "'Date Conversion"
Range("$C$1").Value = "'Date To EPOC"
Range("$D$1").Value = "'License"

' remove any users with null activity status
Dim rng As Range
Set rng = ActiveSheet.UsedRange

For i = rng.Cells.Count To 1 Step -1
    If rng.Item(i).Value = "null" Then
         rng.Item(i).EntireRow.Delete
    End If
Next i

' get number of entries in row
Dim No_Of_Rows As Integer

No_Of_Rows = Range("A1").End(xlDown).Row

'do conversion for date
Dim k  As String
Dim L As String
Dim S As String
Dim a As Integer

For a = 2 To No_Of_Rows
    L = Len(Cells(a, 1).Value)
    S = 6
    Cells(a, 2).Value = Left(Cells(a, 1).Value, L - S)
    Next a

' Date to EPOC
Dim diff As Long

For a = 2 To No_Of_Rows
    
    
    diff = DateDiff("s", "1/1/1970", Cells(a, 2))
    Cells(a, 3).Value = diff
    Next a

Dim Msg As Date
Msg = DateAdd("m", -12, Now)

Dim toUnix As Long
toUnix = DateDiff("s", "1/1/1970", Msg)


For a = 2 To No_Of_Rows
    If Cells(a, 3) > toUnix Then
        Cells(a, 4).Value = "Active License"
    Else
        Cells(a, 4).Value = "Not Active License"
    End If
    Next a
    
' remove any users with Not Active License
Dim rngs As Range
Set rngs = ActiveSheet.UsedRange

For i = rngs.Cells.Count To 1 Step -1
    If rngs.Item(i).Value = "Not Active License" Then
         rngs.Item(i).EntireRow.Delete
    End If
Next i
    
'add titles to 2 new columns
Range("$J$1").Value = "'Count"
Range("$K$1").Value = "'Total"

' get number of entries in row
Dim New_No_Of_Rows As Integer

New_No_Of_Rows = Range("A1").End(xlDown).Row

' check if user is GE or external
For a = 2 To New_No_Of_Rows
    If InStr(Cells(a, 9), "ge.com") > 0 Or InStr(Cells(a, 9), "avioaero.it") > 0 Or InStr(Cells(a, 9), "avioaero.com") > 0 Or InStr(Cells(a, 9), "dowty.com") > 0 Or InStr(Cells(a, 9), "unisonec.com") > 0 Or InStr(Cells(a, 9), "unisonindustries.com") > 0 Or InStr(Cells(a, 9), "geadmin.com") > 0 Then
        Cells(a, 10) = "1"
    ElseIf IsNumeric(Cells(a, 9).Value) = True Then
        Cells(a, 10) = "1"
    Else
        Cells(a, 10) = "0"
    End If
    Next a
    
' sum of Count column
Dim Total As Integer
Total = 0

For a = 2 To New_No_Of_Rows
    Total = Total + Cells(a, 10)
    Next a

Cells(2, 11) = Total
    
    
End Sub
